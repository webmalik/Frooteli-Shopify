<section class="product">
  <div class="product__wrapper">
    <div class="product__images">
      <div class="product__slider swiper">
        <div class="swiper-wrapper">
          {% for image in product.images %}
            <div class="product__slide swiper-slide">
              <img
                src="{{ image | img_url: 'master' }}"
                alt="{{ image.alt | escape }}"
                loading="lazy" />
            </div>
          {% endfor %}
        </div>
        <div class="product__pagination pagination"></div>
      </div>
    </div>

    <div class="product__content">
      <div class="product__info">
        <div class="product__breadcrumbs caption-small">
          <a href="/">Home</a>
          <a href="/collections/{{ collection.handle }}">Shop all</a>
          <span>{{ product.title }}</span>
        </div>
        <div class="product__header">
          <h2 class="product__title">{{ product.title }}</h2>
          <div class="main-text-regular">
            {{ product.description }}
          </div>
        </div>

        <div class="product__labels">
          {% for block in section.blocks %}
            {% if block.type == 'label' %}
              <div class="product__label">
                <img src="{{ block.settings.icon | img_url: 'master' }}" alt="">
                <span>{{ block.settings.text }}</span>
              </div>
            {% endif %}
          {% endfor %}
        </div>

        <div class="product__cost">
          <div class="product__price">
            {{ product.price | money }}
          </div>
          <div class="product__for-price">{{ section.settings.price_note }}</div>
        </div>

        <div class="product__controls">
          <!-- Кількість + кнопка -->
          <quantity-input class="product__counter">
            <button class="product__minus" type="button" name="minus">−</button>
            <div class="product__count">
              <input type="number" value="1" min="1" name="quantity">
            </div>
            <button class="product__plus" type="button" name="plus">+</button>
          </quantity-input>
          <button
            type="submit"
            class="product__button button button--primary"
            onclick="window.flsCart.open()">
            {{ 'products.product.add_to_cart' | t }}
          </button>
        </div>
      </div>

      <div class="product__also">
        <h3 class="product__also-header">{{ section.settings.also_title }}</h3>
        <div class="product__also-wrapper">
          {% for block in section.blocks %}
            {% if block.type == 'also' %}
              <div class="product__also-item">
                <div class="product__also-item-content">
                  <div class="product__also-image">
                    <img src="{{ block.settings.image | img_url: '240x240' }}" alt="">
                  </div>
                  <div class="product__also-info">
                    <p>{{ block.settings.title }}</p>
                    <p>{{ block.settings.price }}</p>
                  </div>
                </div>
                <a href="{{ block.settings.link }}" class="product__also-button">
                  <svg width="61" height="60" viewBox="0 0 61 60" fill="none">
                    <rect width="60" height="60" rx="30" fill="#013501"/>
                    <path d="M22.8 30H39.2" stroke="white" stroke-width="1.4" stroke-linecap="round"/>
                    <path d="M31 38.2V21.8" stroke="white" stroke-width="1.4" stroke-linecap="round"/>
                  </svg>
                </a>
              </div>
            {% endif %}
          {% endfor %}
        </div>
      </div>
    </div>
  </div>
</section>

<section data-fls-spollers class="product-spollers">
  {% for block in section.blocks %}
    {% if block.type == 'spoller' %}
      <details class="product-spollers__item">
        <summary class="product-spollers__title">{{ block.settings.title }}</summary>
        <div class="product-spollers__body">
          {{ block.settings.content }}
        </div>
      </details>
    {% endif %}
  {% endfor %}
</section>

{% schema %}
{
  "name": "Custom product section",
  "tag": "section",
  "settings": [
    {
      "type": "textarea",
      "id": "product_description",
      "label": "Product short description"
    },
    {
      "type": "text",
      "id": "price_note",
      "label": "Price note (e.g., / per 200 g)"
    },
    {
      "type": "text",
      "id": "also_title",
      "label": "Also bought title",
      "default": "Customers also bought"
    }
  ],
  "blocks": [
    {
      "type": "label",
      "name": "Product label",
      "settings": [
        {
          "type": "image_picker",
          "id": "icon",
          "label": "Icon"
        },
        {
          "type": "text",
          "id": "text",
          "label": "Label text"
        }
      ]
    },
    {
      "type": "also",
      "name": "Also bought item",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Product image"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Product title"
        },
        {
          "type": "text",
          "id": "price",
          "label": "Price text"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Link"
        }
      ]
    },
    {
      "type": "spoller",
      "name": "Spoiler block",
      "settings": [
        {
          "type": "text",
          "id": "title",
          "label": "Title"
        },
        {
          "type": "richtext",
          "id": "content",
          "label": "Spoiler content"
        }
      ]
    }
  ],
  "max_blocks": 20,
  "presets": [
    {
      "name": "Product custom layout",
      "category": "Product"
    }
  ]
}
{% endschema %}
