<header class="header" data-fls-header>
  <div class="header__container">
    <div class="header__wrapper">
      <a href="{{ routes.root_url }}" class="header__logo">
        {% if section.settings.logo %}
          <img src="{{ section.settings.logo | img_url: 'master' }}" alt="{{ shop.name }}">
        {% else %}
          {{ shop.name }}
        {% endif %}
      </a>

      <div class="header__menu">
        <div class="menu">
          <button type="button" class="menu__icon icon-menu" data-fls-menu data-fls-dynamic=".header__controls, 991,3">
            <span></span>
          </button>
          <nav class="menu__body">
            <ul class="menu__list">
              {% assign links = linklists[section.settings.main_menu].links %}
              {% for link in links %}
                <li class="menu__item">
                  <a href="{{ link.url }}" class="menu__link">{{ link.title }}</a>
                </li>
              {% endfor %}
            </ul>
            <div class="menu__footer">
              <a href="{{ section.settings.account_url | default: routes.account_login_url }}" class="menu__login">
                {{ 'customer.log_in' | t }}
              </a>
            </div>
          </nav>
        </div>
      </div>

      <div class="header__controls">
        {% if section.settings.show_language_selector %}
        <div class="header__lang" data-fls-dynamic=".menu__footer, 991,2">
			<select name="form[]" data-fls-select data-fls-select-modif="form">
				<option
					value="en"
					data-fls-select-asset="{{'eng.png' | asset_url}}"
					{% if localization.language.iso_code == 'en' %}selected{% endif %}
				>Eng</option>
				<option
					value="pl"
					data-fls-select-asset="{{'pl.svg' | asset_url}}"
					{% if localization.language.iso_code == 'pl' %}selected{% endif %}
				>Pl</option>
				<option
					value="de"
					data-fls-select-asset="{{'de.svg' | asset_url}}"
					{% if localization.language.iso_code == 'de' %}selected{% endif %}
				>De</option>
			</select>
        </div>
        {% endif %}
        <div class="header__icons">
          <a href="{{ routes.account_url }}" class="header__user">
            <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewbox="0 0 26 26" fill="none">
				<circle cx="13.0002" cy="6.50033" r="4.33333" stroke="#013501" stroke-width="1.625"></circle>
				<ellipse cx="13.0002" cy="18.4163" rx="7.58333" ry="4.33333" stroke="#013501" stroke-width="1.625"></ellipse>
			</svg>
          </a>
          <a href="{% if customer %} {{ routes.account_url }}#wishlist {% else %} {{ section.settings.wishlist_link }}{% endif %}" class="header__wishlist">
            <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewbox="0 0 26 26" fill="none">
				<path d="M9.7085 20.4867L10.2115 19.8486L9.7085 20.4867ZM13 5.95896L12.4146 6.5224C12.5677 6.68154 12.7791 6.77146 13 6.77146C13.2208 6.77146 13.4322 6.68154 13.5854 6.5224L13 5.95896ZM16.2914 20.4867L16.7944 21.1248L16.2914 20.4867ZM9.7085 20.4867L10.2115 19.8486C8.56955 18.5543 6.77412 17.2902 5.34977 15.6864C3.95328 14.1139 2.97913 12.279 2.97913 9.89846H2.16663H1.35413C1.35413 12.7861 2.55716 14.989 4.13474 16.7654C5.68445 18.5104 7.65996 19.9064 9.2055 21.1248L9.7085 20.4867ZM2.16663 9.89846H2.97913C2.97913 7.56836 4.29577 5.61434 6.09301 4.79281C7.83903 3.9947 10.1851 4.20606 12.4146 6.5224L13 5.95896L13.5854 5.39552C10.94 2.64709 7.86939 2.19411 5.41745 3.3149C3.01673 4.41227 1.35413 6.96039 1.35413 9.89846H2.16663ZM9.7085 20.4867L9.2055 21.1248C9.76042 21.5623 10.3561 22.0287 10.9598 22.3815C11.5633 22.7341 12.252 23.0208 13 23.0208V22.2083V21.3958C12.6646 21.3958 12.2699 21.265 11.7797 20.9785C11.2897 20.6922 10.7814 20.2979 10.2115 19.8486L9.7085 20.4867ZM16.2914 20.4867L16.7944 21.1248C18.34 19.9064 20.3155 18.5104 21.8652 16.7654C23.4428 14.989 24.6458 12.7861 24.6458 9.89846H23.8333H23.0208C23.0208 12.279 22.0466 14.1139 20.6501 15.6864C19.2258 17.2902 17.4304 18.5543 15.7884 19.8486L16.2914 20.4867ZM23.8333 9.89846H24.6458C24.6458 6.96039 22.9832 4.41227 20.5825 3.3149C18.1305 2.19411 15.0599 2.64709 12.4146 5.39552L13 5.95896L13.5854 6.5224C15.8148 4.20606 18.1609 3.9947 19.9069 4.79281C21.7041 5.61434 23.0208 7.56836 23.0208 9.89846H23.8333ZM16.2914 20.4867L15.7884 19.8486C15.2185 20.2979 14.7102 20.6922 14.2202 20.9785C13.73 21.265 13.3354 21.3958 13 21.3958V22.2083V23.0208C13.7479 23.0208 14.4366 22.7341 15.0401 22.3815C15.6438 22.0287 16.2395 21.5623 16.7944 21.1248L16.2914 20.4867Z" fill="#013501"></path>
			</svg>
          </a>
          <div class="header__cart" data-cart-open>
            <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewbox="0 0 26 26" fill="none">
				<path d="M4.05346 22.2674C5.35306 23.8333 7.77182 23.8333 12.6093 23.8333H13.3906C18.2282 23.8333 20.6469 23.8333 21.9465 22.2674M4.05346 22.2674C2.75387 20.7015 3.19962 18.3242 4.09112 13.5695C4.72511 10.1882 5.04211 8.49759 6.24558 7.49879M4.05346 22.2674C4.05346 22.2674 4.05347 22.2674 4.05346 22.2674ZM21.9465 22.2674C23.2461 20.7015 22.8004 18.3242 21.9089 13.5695C21.2749 10.1882 20.9579 8.49759 19.7544 7.49879M21.9465 22.2674C21.9465 22.2674 21.9465 22.2674 21.9465 22.2674ZM19.7544 7.49879C18.5509 6.5 16.8308 6.5 13.3906 6.5H12.6093C9.16915 6.5 7.44905 6.5 6.24558 7.49879M19.7544 7.49879C19.7544 7.49879 19.7544 7.49879 19.7544 7.49879ZM6.24558 7.49879C6.24558 7.49879 6.24558 7.49879 6.24558 7.49879Z" stroke="#013501" stroke-width="1.625"></path>
				<path d="M16.2499 11.917L17.3332 18.417" stroke="#013501" stroke-width="1.625" stroke-linecap="round"></path>
				<path d="M9.74988 11.917L8.66654 18.417" stroke="#013501" stroke-width="1.625" stroke-linecap="round"></path>
				<path d="M9.74988 6.50033V5.41699C9.74988 3.62207 11.205 2.16699 12.9999 2.16699C14.7948 2.16699 16.2499 3.62207 16.2499 5.41699V6.50033" stroke="#013501" stroke-width="1.625" stroke-linecap="round"></path>
			</svg>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>

{% schema %}
{
  "name": "Header",
  "settings": [
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Logo"
    },
    {
      "type": "link_list",
      "id": "main_menu",
      "label": "Main navigation",
      "default": "main-menu"
    },
    {
      "type": "url",
      "id": "wishlist_link",
      "label": "Wishlist URL",
    },
    {
      "type": "checkbox",
      "id": "show_language_selector",
      "label": "Show language selector",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_currency_selector",
      "label": "Show currency selector",
      "default": true
    }
  ],
  "blocks": [],
  "presets": [
    {
      "name": "Header"
    }
  ]
}
{% endschema %}

<script src="{{ 'header.js' | asset_url }}" defer="defer"></script>

<script>
document.addEventListener("selectCallback", function (e) {
	const select = e.detail.select;
	const value = select.value;

	if (!value) return;

	// Перемикач мови
	if (select.name === 'form[]' && select.closest('.header__lang')) {
		const langCode = value.toLowerCase();
		const currentLocale = window.Shopify.locale?.toLowerCase();
		const defaultLocale = 'en'; // заміни на свій дефолт, якщо не англійська

		if (langCode === currentLocale) return;

		const path = window.location.pathname.replace(/^\/[a-z]{2}(\/|$)/, '/');
		const query = window.location.search;

		const redirectUrl =
			langCode === defaultLocale
				? `${path}${query}`
				: `/${langCode}${path}${query}`;

		window.location.href = redirectUrl;
	}

	// Перемикач валюти (через Shopify Localization API)
	if (select.name === 'country') {
		const form = document.createElement('form');
		form.method = 'POST';
		form.action = '/localization';
		form.style.display = 'none';

		const input = document.createElement('input');
		input.name = 'country_code';
		input.value = value;

		form.appendChild(input);
		document.body.appendChild(form);
		form.submit();
	}
});
</script>
